{% extends "base.html" %}

{% block title %}Dashboard - Alumni Mentor Portal{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2"><i class="fas fa-tachometer-alt"></i> Dashboard</h1>
</div>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="fas fa-user-tie fa-2x mb-2"></i>
                <div class="stats-number">{{ stats.alumni_count if stats else 0 }}</div>
                <div class="stats-label">Alumni</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="fas fa-user-graduate fa-2x mb-2"></i>
                <div class="stats-number">{{ stats.student_count if stats else 0 }}</div>
                <div class="stats-label">Students</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="fas fa-comments fa-2x mb-2"></i>
                <div class="stats-number">{{ stats.session_count if stats else 0 }}</div>
                <div class="stats-label">Sessions</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="fas fa-star fa-2x mb-2"></i>
                <div class="stats-number">{{ stats.feedback_count if stats else 0 }}</div>
                <div class="stats-label">Feedback</div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-chart-line"></i> Database Summary</h5>
            </div>
            <div class="card-body">
                <table class="table table-sm">
                    <tr>
                        <td><strong>Total Users:</strong></td>
                        <td>{{ (stats.alumni_count if stats else 0) + (stats.student_count if stats else 0) }}</td>
                    </tr>
                    <tr>
                        <td><strong>Active Sessions:</strong></td>
                        <td>{{ stats.session_count if stats else 0 }}</td>
                    </tr>
                    <tr>
                        <td><strong>Feedback Provided:</strong></td>
                        <td>{{ stats.feedback_count if stats else 0 }}</td>
                    </tr>
                    <tr>
                        <td><strong>Feedback per Session:</strong></td>
                        <td>
                            {% if stats.session_count > 0 %}
                                {{ "%.2f"|format(stats.feedback_count / stats.session_count) }}
                            {% else %}
                                0.00
                            {% endif %}
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-clock"></i> Recent Mentorship Sessions</h5>
            </div>
            <div class="card-body">
                {% if stats.recent_sessions and stats.recent_sessions|length > 0 %}
                    <div class="list-group list-group-flush">
                        {% for session in stats.recent_sessions %}
                        <div class="list-group-item">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <strong>{{ session.Alumni_Name }}</strong> mentored
                                    <strong>{{ session.Student_Name }}</strong>
                                </div>
                                <small class="text-muted">{{ session.Session_Date }}</small>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class="text-muted text-center">No recent sessions found</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-bolt"></i> Active Database Features</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="fas fa-shield-alt text-success"></i> Validation Triggers</h6>
                        <ul>
                            <li>Email uniqueness enforcement</li>
                            <li>Phone number format validation</li>
                            <li>Rating constraints (1-5)</li>
                            <li>Year of study validation</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-cogs text-primary"></i> Automated Features</h6>
                        <ul>
                            <li>Auto-calculation of experience</li>
                            <li>Automatic feedback logging</li>
                            <li>Mentor relationship creation</li>
                            <li>Premium mentor status updates</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-3">
        <a href="{{ url_for('add_alumni') }}" class="btn btn-primary btn-lg w-100">
            <i class="fas fa-plus"></i> Add Alumni
        </a>
    </div>
    <div class="col-md-3">
        <a href="{{ url_for('add_student') }}" class="btn btn-success btn-lg w-100">
            <i class="fas fa-plus"></i> Add Student
        </a>
    </div>
    <div class="col-md-3">
        <a href="{{ url_for('add_session') }}" class="btn btn-info btn-lg w-100">
            <i class="fas fa-plus"></i> Add Session
        </a>
    </div>
    <!-- <div class="col-md-3">
        <a href="{{ url_for('test_triggers') }}" class="btn btn-warning btn-lg w-100">
            <i class="fas fa-bolt"></i> Test Triggers
        </a>
    </div> -->
</div>
{% endblock %}